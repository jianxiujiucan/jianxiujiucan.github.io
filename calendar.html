<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>仿 windows 10 日历</title>
  <link rel="stylesheet" href="css/calendar.css">
  <style>
    

    
  </style>
</head>

<body>
  <div class="calendar">
    <div class="header">
      <p><span id="currentYear"></span>年<span id="currentMonth"></span>月</p>
      <div class="button">
        <button id="lastMonth"><i class="arrow arrow--up"></i></button>
        <button id="nextMonth"><i class="arrow arrow--down"></i></button>
      </div>
    </div>
    <div class="body">
      <div class="week-list">
        <span>日</span>
        <span>一</span>
        <span>二</span>
        <span>三</span>
        <span>四</span>
        <span>五</span>
        <span>六</span>
      </div>
      <div class="data-list" id="dateList"></div>
    </div>
  </div>
  <script>
    let $dataList = document.getElementById('dateList')
    let $buttonLast = document.getElementById('lastMonth')
    let $buttonNext = document.getElementById('nextMonth')
    let $currentYear = document.getElementById('currentYear')
    let $currentMonth = document.getElementById('currentMonth')
    let date = new Date()
    let currentYear = date.getFullYear() //当前年份
    let currentMonth = date.getMonth() // 当前月份
    let currentDay = date.getDate() //当前几号
    calendar(currentYear, currentMonth)

    // 判断是否是闰年
    function isLeapYear(year) {
      if (year % 4 === 0 && year % 100 != 0 || year % 400 === 0) {
        return 29
      } else {
        return 28
      }
    }

    function calendar(year, month) {
      $currentYear.innerHTML = year
      $currentMonth.innerHTML = month + 1
      let contentList = ``
      let days = [31, isLeapYear(year), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31] // 当年月份的天数数组
      let firstDay = new Date(year, month, 1) //当前月份第一天信息
      let items = 0 // 元素计数

      // 上个月日期生成
      for (let i = firstDay.getDay() - 1; i >= 0; i--) {
        let over = month === 0 ? 31 : days[month - 1]
        contentList += `<div class="item disabled-month"><span>${over - i}</span></div>`
        items++
      }
      // 当前月份日期生成
      for (let i = 1; i <= days[month]; i++) {
        if (i === currentDay && month === date.getMonth() && year === date.getFullYear()) { //当天选中态
          contentList += `<div class="item current"><span>${i}</span></div>`
        } else {
          contentList += `<div class="item"><span>${i}</span></div>`
        }
        items++
      }

      // 下个月日期生成
      let lastDay = new Date(year, month, days[month])

      for (let i = 1; i < 7 - lastDay.getDay(); i++) {
        contentList += `<div class="item disabled-month"><span>${i}</span></div>`
        items++
      }

      // 如果当前月份不足6列，则填充1列，保证每次生成6列才不会跳。
      if (items < 42) {
        for (let i = 1; i <= 7; i++) {
          contentList += `<div class="item disabled-month"><span>${i}</span></div>`
        }
      }
      $dataList.innerHTML = contentList //将生成的dom结构填充到页面里
    }


    $buttonLast.addEventListener('click', function () {
      currentMonth--
      if (currentMonth < 0) {
        currentYear -= 1
        currentMonth = 11
      }
      calendar(currentYear, currentMonth)
    })

    $buttonNext.addEventListener('click', function () {
      currentMonth++
      if (currentMonth > 11) {
        currentYear += 1
        currentMonth = 0
      }
      calendar(currentYear, currentMonth)
    })

    document.addEventListener('DOMContentLoaded', function () {
      let items = document.querySelectorAll('.item')
      for (let item of items) {
        item.addEventListener('click', function () {
          
          for(let i=0; i<items.length; i++){
            items[i].classList.remove('is-active')
          }
          this.classList.add('is-active')
        });
      }
    });



  </script>
</body>

</html>